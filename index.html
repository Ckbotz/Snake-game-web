<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doodle Jump - BY NIDHI UPMAN</title>
    <style>
        body {
            text-align: center;
            font-family: sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }

        #board {
            background-image: url("./doodlejumpbg.png");
            border: 2px solid #333;
            margin: 20px auto;
            display: block;
        }

        .controls {
            margin: 20px auto;
            display: flex;
            justify-content: center;
            gap: 20px;
            max-width: 360px;
        }

        .control-btn {
            width: 80px;
            height: 80px;
            font-size: 24px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.1s;
        }

        .control-btn:active {
            transform: scale(0.95);
            box-shadow: 0 2px 3px rgba(0,0,0,0.1);
        }

        .control-btn:hover {
            background-color: #45a049;
        }

        #restartBtn {
            margin: 10px auto;
            padding: 15px 30px;
            font-size: 18px;
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: none;
            font-weight: bold;
        }

        #restartBtn:hover {
            background-color: #0b7dda;
        }

        h1 {
            color: #333;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div>
        <h1>Doodle Jump - BY NIDHI UPMAN</h1>
    </div>

    <canvas id="board"></canvas>

    <div class="controls">
        <button class="control-btn" id="leftBtn">◄</button>
        <button class="control-btn" id="rightBtn">►</button>
    </div>

    <button id="restartBtn">Restart Game</button>

    <script>
        //board
        let board;
        let boardWidth = 360;
        let boardHeight = 576;
        let context;

        //doodler
        let doodlerWidth = 46;
        let doodlerHeight = 46;
        let doodlerX = boardWidth/2 - doodlerWidth/2;
        let doodlerY = boardHeight*7/8 - doodlerHeight;
        let doodlerRightImg;
        let doodlerLeftImg;

        let doodler = {
            img : null,
            x : doodlerX,
            y : doodlerY,
            width : doodlerWidth,
            height : doodlerHeight
        }

        //physics
        let velocityX = 0; 
        let velocityY = 0;
        let initialVelocityY = -8;
        let gravity = 0.4;

        //platforms
        let platformArray = [];
        let platformWidth = 60;
        let platformHeight = 18;
        let platformImg;

        let score = 0;
        let maxScore = 0;
        let gameOver = false;

        window.onload = function() {
            board = document.getElementById("board");
            board.height = boardHeight;
            board.width = boardWidth;
            context = board.getContext("2d");

            //load images
            doodlerRightImg = new Image();
            doodlerRightImg.src = "./doodler-right.png";
            doodler.img = doodlerRightImg;
            doodlerRightImg.onload = function() {
                context.drawImage(doodler.img, doodler.x, doodler.y, doodler.width, doodler.height);
            }

            doodlerLeftImg = new Image();
            doodlerLeftImg.src = "./doodler-left.png";

            platformImg = new Image();
            platformImg.src = "./platform.png";

            velocityY = initialVelocityY;
            placePlatforms();
            requestAnimationFrame(update);

            // Touch controls
            document.getElementById("leftBtn").addEventListener("touchstart", function(e) {
                e.preventDefault();
                moveLeft();
            });

            document.getElementById("leftBtn").addEventListener("mousedown", function(e) {
                e.preventDefault();
                moveLeft();
            });

            document.getElementById("rightBtn").addEventListener("touchstart", function(e) {
                e.preventDefault();
                moveRight();
            });

            document.getElementById("rightBtn").addEventListener("mousedown", function(e) {
                e.preventDefault();
                moveRight();
            });

            document.getElementById("leftBtn").addEventListener("touchend", stopMoving);
            document.getElementById("leftBtn").addEventListener("mouseup", stopMoving);
            document.getElementById("rightBtn").addEventListener("touchend", stopMoving);
            document.getElementById("rightBtn").addEventListener("mouseup", stopMoving);

            document.getElementById("restartBtn").addEventListener("click", restartGame);
        }

        function moveLeft() {
            velocityX = -4;
            doodler.img = doodlerLeftImg;
        }

        function moveRight() {
            velocityX = 4;
            doodler.img = doodlerRightImg;
        }

        function stopMoving() {
            velocityX = 0;
        }

        function restartGame() {
            doodler = {
                img : doodlerRightImg,
                x : doodlerX,
                y : doodlerY,
                width : doodlerWidth,
                height : doodlerHeight
            }

            velocityX = 0;
            velocityY = initialVelocityY;
            score = 0;
            maxScore = 0;
            gameOver = false;
            placePlatforms();
            document.getElementById("restartBtn").style.display = "none";
        }

        function update() {
            requestAnimationFrame(update);
            if (gameOver) {
                document.getElementById("restartBtn").style.display = "block";
                return;
            }
            context.clearRect(0, 0, board.width, board.height);

            //doodler
            doodler.x += velocityX;
            if (doodler.x > boardWidth) {
                doodler.x = 0;
            }
            else if (doodler.x + doodler.width < 0) {
                doodler.x = boardWidth;
            }

            velocityY += gravity;
            doodler.y += velocityY;
            if (doodler.y > board.height) {
                gameOver = true;
            }
            context.drawImage(doodler.img, doodler.x, doodler.y, doodler.width, doodler.height);

            //platforms
            for (let i = 0; i < platformArray.length; i++) {
                let platform = platformArray[i];
                if (velocityY < 0 && doodler.y < boardHeight*3/4) {
                    platform.y -= initialVelocityY;
                }
                if (detectCollision(doodler, platform) && velocityY >= 0) {
                    velocityY = initialVelocityY;
                }
                context.drawImage(platform.img, platform.x, platform.y, platform.width, platform.height);
            }

            while (platformArray.length > 0 && platformArray[0].y >= boardHeight) {
                platformArray.shift();
                newPlatform();
            }

            //score
            updateScore();
            context.fillStyle = "black";
            context.font = "16px sans-serif";
            context.fillText(score, 5, 20);

            if (gameOver) {
                context.fillStyle = "red";
                context.font = "20px sans-serif";
                context.fillText("Game Over!", boardWidth/2 - 50, boardHeight/2);
            }
        }

        function placePlatforms() {
            platformArray = [];

            let platform = {
                img : platformImg,
                x : boardWidth/2,
                y : boardHeight - 50,
                width : platformWidth,
                height : platformHeight
            }

            platformArray.push(platform);

            for (let i = 0; i < 6; i++) {
                let randomX = Math.floor(Math.random() * boardWidth*3/4);
                let platform = {
                    img : platformImg,
                    x : randomX,
                    y : boardHeight - 75*i - 150,
                    width : platformWidth,
                    height : platformHeight
                }
            
                platformArray.push(platform);
            }
        }

        function newPlatform() {
            let randomX = Math.floor(Math.random() * boardWidth*3/4);
            let platform = {
                img : platformImg,
                x : randomX,
                y : -platformHeight,
                width : platformWidth,
                height : platformHeight
            }

            platformArray.push(platform);
        }

        function detectCollision(a, b) {
            return a.x < b.x + b.width &&
                   a.x + a.width > b.x &&
                   a.y < b.y + b.height &&
                   a.y + a.height > b.y;
        }

        function updateScore() {
            let points = Math.floor(50*Math.random());
            if (velocityY < 0) {
                maxScore += points;
                if (score < maxScore) {
                    score = maxScore;
                }
            }
            else if (velocityY >= 0) {
                maxScore -= points;
            }
        }
    </script>
</body>
</html>
